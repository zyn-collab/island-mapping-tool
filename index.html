<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map What's Here</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Main container for the entire app -->
    <div class="container-fluid">
        <!-- Start Screen -->
        <div id="start-screen" class="screen active">
            <div class="text-center">
                <h1 class="app-title">Map what's here</h1>
                <p class="app-subtitle">Help build your island's map</p>
                <button id="start-btn" class="btn btn-primary btn-lg">Start a new entry</button>
            </div>
        </div>

        <!-- Location Screen -->
        <div id="location-screen" class="screen">
            <div class="screen-header">
                <h2>Confirm your location</h2>
                <p class="text-muted">We use your GPS to place a pin. Move the pin if needed.</p>
            </div>
            
            <!-- GPS Status and Coordinates Display -->
            <div id="gps-status" class="gps-info">
                <div class="row">
                    <div class="col-6">
                        <small class="text-muted">Latitude:</small>
                        <div id="lat-display">--</div>
                    </div>
                    <div class="col-6">
                        <small class="text-muted">Longitude:</small>
                        <div id="lon-display">--</div>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-12">
                        <small class="text-muted">GPS Accuracy:</small>
                        <div id="accuracy-display">--</div>
                    </div>
                </div>
            </div>

            <!-- Map Container -->
            <div id="map" class="map-container"></div>

            <!-- Location Controls -->
            <div class="location-controls">
                <button id="recenter-btn" class="btn btn-outline-primary">Recenter on me</button>
                <button id="manual-search-btn" class="btn btn-outline-secondary">Search place</button>
            </div>

            <!-- Manual Search Input (hidden by default) -->
            <div id="manual-search" class="manual-search" style="display: none;">
                <input type="text" id="search-input" class="form-control" placeholder="Search for a place or enter lat,lon">
                <button id="search-btn" class="btn btn-primary">Search</button>
            </div>

            <!-- Confirm Location Button -->
            <div class="confirm-section">
                <button id="confirm-location-btn" class="btn btn-success btn-lg">Looks right</button>
            </div>
        </div>

        <!-- Form Screen -->
        <div id="form-screen" class="screen">
            <div class="screen-header">
                <h2>What are you mapping?</h2>
            </div>

            <!-- Category Selection -->
            <div class="form-section">
                <label for="category-select" class="form-label">Category *</label>
                <select id="category-select" class="form-select" required>
                    <option value="">Select a category...</option>
                </select>
            </div>

            <!-- Subcategory Selection -->
            <div class="form-section">
                <label for="subcategory-select" class="form-label">Subcategory *</label>
                <select id="subcategory-select" class="form-select" required>
                    <option value="">Select a subcategory...</option>
                </select>
            </div>

            <!-- Dynamic Fields Container -->
            <div id="dynamic-fields"></div>

            <!-- Tags Selection -->
            <div class="form-section">
                <label class="form-label">Tags (optional)</label>
                <div id="tags-container" class="tags-container"></div>
            </div>

            <!-- Notes -->
            <div class="form-section">
                <label for="notes-input" class="form-label">Notes</label>
                <textarea id="notes-input" class="form-control" rows="3" placeholder="Short description. Keep it factual." maxlength="1000"></textarea>
                <div class="text-muted small">Characters: <span id="notes-count">0</span>/1000</div>
            </div>

            <!-- Photos -->
            <div class="form-section">
                <label class="form-label">Photos (optional)</label>
                <div id="photo-container" class="photo-container">
                    <input type="file" id="photo-input" accept="image/*" multiple style="display: none;">
                    <button id="add-photo-btn" class="btn btn-outline-primary">Add Photo</button>
                </div>
                <div id="photo-preview" class="photo-preview"></div>
            </div>

            <!-- Contact Fields (shown for business categories) -->
            <div id="contact-fields" class="form-section" style="display: none;">
                <h5>Contact Information</h5>
                <div class="mb-3">
                    <label for="contact-name" class="form-label">Contact Name</label>
                    <input type="text" id="contact-name" class="form-control">
                </div>
                <div class="mb-3">
                    <label for="contact-phone" class="form-label">Contact Phone</label>
                    <input type="tel" id="contact-phone" class="form-control">
                </div>
                <div class="mb-3">
                    <label for="contact-other" class="form-label">Other Contact Info</label>
                    <input type="text" id="contact-other" class="form-control">
                </div>
            </div>

            <!-- Submit Button -->
            <div class="submit-section">
                <button id="submit-btn" class="btn btn-success btn-lg">Submit</button>
            </div>
        </div>

        <!-- Success Screen -->
        <div id="success-screen" class="screen">
            <div class="text-center">
                <h2>Thanks!</h2>
                <p>Your entry was sent successfully.</p>
                <button id="new-entry-btn" class="btn btn-primary">Make another entry</button>
                <div class="mt-3">
                    <a href="#" id="privacy-link" class="text-muted small">Privacy & Consent Info</a>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay" style="display: none;">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="loading-text">Submitting...</div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
